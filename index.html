<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Enhanced 3D Solar System</title>
  <style>
    body { 
      margin: 0; 
      overflow: hidden; 
      background-color: #000;
      font-family: 'Arial', sans-serif;
      touch-action: none;
    }
    canvas { 
      display: block; 
      touch-action: none;
    }
    #controls {
      position: absolute; 
      top: 10px; 
      left: 10px;
      background: rgba(0, 0, 0, 0.7); 
      padding: 15px;
      color: white; 
      border-radius: 10px;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      max-width: 250px;
      z-index: 10;
    }
    #infoPanel {
      position: absolute; 
      bottom: 20px; 
      left: 20px;
      background: rgba(0, 0, 0, 0.85); 
      padding: 15px;
      color: white; 
      border-radius: 10px;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      max-width: 300px;
      display: none;
      z-index: 10;
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
    }
    button, select, .slider-container {
      margin: 8px 5px; 
      padding: 10px; 
      font-size: 14px;
      cursor: pointer; 
      border-radius: 5px;
      background-color: rgba(50, 50, 50, 0.8); 
      color: white; 
      border: 1px solid rgba(255, 255, 255, 0.2);
      width: 100%;
      transition: all 0.3s ease;
    }
    button:hover, select:hover {
      background-color: #555; 
      transform: translateY(-2px);
    }
    h3 {
      margin: 5px 0;
      color: #ffcc00;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      padding-bottom: 5px;
    }
    .slider-container {
      background: transparent;
      padding: 0;
      border: none;
    }
    input[type="range"] {
      width: 100%;
    }
    .label-row {
      display: flex;
      justify-content: space-between;
      margin-top: 5px;
    }
    #musicToggle {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 100;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }
    #loading {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      color: white;
      font-size: 24px;
    }
    #planetLabel {
      position: absolute;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 8px 12px;
      border-radius: 5px;
      font-size: 14px;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: 9;
    }
    .close-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: none;
      border: none;
      color: white;
      font-size: 20px;
      cursor: pointer;
      width: auto;
    }
  </style>
</head>
<body>
  <div id="loading">Loading Solar System...</div>
  
  <div id="controls">
    <h3>Solar System Controls</h3>
    <button id="changeCamera">Change Camera View</button>
    <button id="toggleOrbits">Toggle Orbits</button>
    <button id="toggleAutoRotate">Auto-Rotation: On</button>
    <br>
    <label for="speedControl">Simulation Speed:</label>
    <select id="speedControl">
      <option value="0">Paused</option>
      <option value="0.1">0.1x (Slow)</option>
      <option value="0.25">0.25x</option>
      <option value="0.5">0.5x</option>
      <option value="1" selected>1x (Normal)</option>
      <option value="2">2x (Fast)</option>
      <option value="5">5x (Very Fast)</option>
    </select>
    
    <div class="slider-container">
      <label for="zoomControl">Zoom Level:</label>
      <input type="range" id="zoomControl" min="30" max="150" value="75">
      <div class="label-row">
        <span>Close</span>
        <span>Far</span>
      </div>
    </div>

    <div class="slider-container">
      <label for="rotationSpeed">Rotation Sensitivity:</label>
      <input type="range" id="rotationSpeed" min="0.5" max="3" step="0.1" value="1.5">
      <div class="label-row">
        <span>Slow</span>
        <span>Fast</span>
      </div>
    </div>
  </div>

  <div id="infoPanel">
    <button class="close-btn" id="closeInfo">Ã—</button>
    <h3 id="planetName">Planet Name</h3>
    <p id="planetInfo">Information will appear here</p>
  </div>

  <div id="planetLabel"></div>

  <div id="musicToggle">ðŸ”‡</div>

  <audio id="backgroundMusic" loop>
    <source src="music1.mp3" type="audio/mpeg">
  </audio>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
<script>
  // Wait for resources to load
  window.addEventListener('load', function() {
    document.getElementById('loading').style.display = 'none';
  });

  // Scene setup
  const scene = new THREE.Scene();
  const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 2000);
  const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
  renderer.setSize(window.innerWidth, window.innerHeight);
  renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
  document.body.appendChild(renderer.domElement);

  // Add subtle fog for depth effect
  scene.fog = new THREE.FogExp2(0x000033, 0.0005);

  // Enhanced background stars with different sizes and colors
  const starsGeometry = new THREE.BufferGeometry();
  const starsMaterial = new THREE.PointsMaterial({
    color: 0xffffff,
    size: 0.7,
    transparent: true
  });

  const starsVertices = [];
  
  for (let i = 0; i < 10000; i++) {
    const x = (Math.random() - 0.5) * 2000;
    const y = (Math.random() - 0.5) * 2000;
    const z = (Math.random() - 0.5) * 2000;
    starsVertices.push(x, y, z);
  }
  
  starsGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starsVertices, 3));
  const starField = new THREE.Points(starsGeometry, starsMaterial);
  scene.add(starField);

  // Sun with glow effect
  const sunGeometry = new THREE.SphereGeometry(8, 64, 64);
  const sunMaterial = new THREE.MeshBasicMaterial({ 
    color: 0xffd700
  });
  const sun = new THREE.Mesh(sunGeometry, sunMaterial);
  scene.add(sun);

  // Sun glow effect
  const sunGlowGeometry = new THREE.SphereGeometry(8.8, 32, 32);
  const sunGlowMaterial = new THREE.MeshBasicMaterial({
    color: 0xff9900,
    transparent: true,
    opacity: 0.3
  });
  const sunGlow = new THREE.Mesh(sunGlowGeometry, sunGlowMaterial);
  scene.add(sunGlow);

  // Sun light
  const sunLight = new THREE.PointLight(0xffddaa, 2, 300);
  scene.add(sunLight);

  // Ambient light for overall illumination
  const ambientLight = new THREE.AmbientLight(0x333333);
  scene.add(ambientLight);

  // Planets data with more accurate details
  const planets = [
    { 
      name: "Mercury", 
      size: 1.8, 
      orbitRadius: 20, 
      speed: 0.02, 
      color: 0x888888, 
      period: 88,
      info: "The smallest planet in our solar system and closest to the Sun. It has no atmosphere and extreme temperature variations."
    },
    { 
      name: "Venus",   
      size: 2.2, 
      orbitRadius: 28, 
      speed: 0.015, 
      color: 0xe6e6fa, 
      period: 225,
      info: "Second planet from the Sun. Similar in size to Earth but with a toxic atmosphere of carbon dioxide and crushing air pressure."
    },
    { 
      name: "Earth",   
      size: 2.4, 
      orbitRadius: 36, 
      speed: 0.01, 
      color: 0x2288ff, 
      period: 365,
      info: "Our home planet. The only known celestial body to support life. Has one natural satellite - the Moon."
    },
    { 
      name: "Mars",    
      size: 1.9, 
      orbitRadius: 44, 
      speed: 0.008, 
      color: 0xff4500, 
      period: 687,
      info: "The Red Planet. Has the largest volcano and canyon in the solar system. Two small moons: Phobos and Deimos."
    },
    { 
      name: "Jupiter", 
      size: 4.5, 
      orbitRadius: 58, 
      speed: 0.005, 
      color: 0xffaa33, 
      period: 4333,
      info: "The largest planet in our solar system. A gas giant with a prominent Great Red Spot - a giant storm."
    },
    { 
      name: "Saturn",  
      size: 4.0, 
      orbitRadius: 75, 
      speed: 0.004, 
      color: 0xffcc99, 
      period: 10759,
      info: "Known for its extensive ring system. A gas giant with a density lower than water - it would float in a giant ocean!"
    },
  ];

  // Create orbit paths
  const orbitGroup = new THREE.Group();
  planets.forEach(planet => {
    const orbitGeometry = new THREE.RingGeometry(planet.orbitRadius - 0.1, planet.orbitRadius + 0.1, 128);
    const orbitMaterial = new THREE.MeshBasicMaterial({ 
      color: 0x444444, 
      side: THREE.DoubleSide,
      transparent: true,
      opacity: 0.3
    });
    const orbit = new THREE.Mesh(orbitGeometry, orbitMaterial);
    orbit.rotation.x = Math.PI / 2;
    orbitGroup.add(orbit);
  });
  scene.add(orbitGroup);

  // Create planets with more detail
  const planetMeshes = planets.map(p => {
    const mesh = new THREE.Mesh(
      new THREE.SphereGeometry(p.size, 32, 32),
      new THREE.MeshPhongMaterial({ 
        color: p.color,
        shininess: 10
      })
    );
    
    // Add subtle specular highlight
    mesh.material.specular = new THREE.Color(0x222222);
    
    scene.add(mesh);
    return { ...p, mesh, angle: Math.random() * Math.PI * 2 };
  });

  // Earth's moon
  const moonGeometry = new THREE.SphereGeometry(0.6, 32, 32);
  const moonMaterial = new THREE.MeshStandardMaterial({ 
    color: 0xdddddd,
    roughness: 0.8,
    metalness: 0.1
  });
  const moon = new THREE.Mesh(moonGeometry, moonMaterial);
  scene.add(moon);

  // Add Saturn's rings
  const saturn = planetMeshes.find(p => p.name === "Saturn");
  if (saturn) {
    const ringGeometry = new THREE.RingGeometry(4.5, 6.5, 64);
    const ringMaterial = new THREE.MeshBasicMaterial({ 
      color: 0xf0e6a2, 
      side: THREE.DoubleSide,
      transparent: true,
      opacity: 0.8
    });
    const ring = new THREE.Mesh(ringGeometry, ringMaterial);
    ring.rotation.x = Math.PI / 2;
    saturn.mesh.add(ring);
  }

  // Camera positions with more interesting angles
  let camIndex = 0;
  const cameraPositions = [
    {x: 0, y: 50, z: 100},        // Default overview
    {x: 0, y: 100, z: 0},         // Top down view
    {x: 100, y: 20, z: 0},        // Side view
    {x: 30, y: 10, z: 40},        // Earth close-up view
    {x: 0, y: 5, z: 70},          // Sun-focused view
  ];
  
  function switchCamera() {
    camIndex = (camIndex + 1) % cameraPositions.length;
    const pos = cameraPositions[camIndex];
    
    gsap.to(camera.position, {
      x: pos.x,
      y: pos.y,
      z: pos.z,
      duration: 1.5,
      ease: "power2.inOut",
      onUpdate: () => camera.lookAt(0, 0, 0)
    });
  }
  
  document.getElementById('changeCamera').addEventListener('click', switchCamera);

  // Speed control
  let speedMode = 1;
  document.getElementById('speedControl').addEventListener('change', (e) => {
    speedMode = parseFloat(e.target.value);
  });

  // Zoom control
  document.getElementById('zoomControl').addEventListener('input', (e) => {
    camera.fov = e.target.value;
    camera.updateProjectionMatrix();
  });

  // Toggle orbits visibility
  document.getElementById('toggleOrbits').addEventListener('click', () => {
    orbitGroup.visible = !orbitGroup.visible;
  });

  // Auto-rotation toggle
  let autoRotate = true;
  document.getElementById('toggleAutoRotate').addEventListener('click', function() {
    autoRotate = !autoRotate;
    this.textContent = 'Auto-Rotation: ' + (autoRotate ? 'On' : 'Off');
  });

  // Planet information panel
  const infoPanel = document.getElementById('infoPanel');
  const planetName = document.getElementById('planetName');
  const planetInfo = document.getElementById('planetInfo');
  const planetLabel = document.getElementById('planetLabel');
  
  document.getElementById('closeInfo').addEventListener('click', () => {
    infoPanel.style.display = 'none';
  });
  
  // Raycaster for planet selection
  const raycaster = new THREE.Raycaster();
  const mouse = new THREE.Vector2();
  
  function onMouseClick(event) {
    // Calculate mouse position in normalized device coordinates
    mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
    mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
    
    // Update the picking ray with the camera and mouse position
    raycaster.setFromCamera(mouse, camera);
    
    // Calculate objects intersecting the picking ray
    const intersects = raycaster.intersectObjects(planetMeshes.map(p => p.mesh));
    
    if (intersects.length > 0) {
      const planet = planetMeshes.find(p => p.mesh === intersects[0].object);
      if (planet) {
        planetName.textContent = planet.name;
        planetInfo.textContent = planet.info;
        infoPanel.style.display = 'block';
        
        // Animate camera to focus on the selected planet
        const planetPosition = planet.mesh.position.clone();
        const cameraDirection = new THREE.Vector3().subVectors(camera.position, planetPosition).normalize();
        const targetPosition = planetPosition.clone().add(cameraDirection.multiplyScalar(planet.size * 5));
        
        gsap.to(camera.position, {
          x: targetPosition.x,
          y: targetPosition.y,
          z: targetPosition.z,
          duration: 2,
          ease: "power2.inOut",
          onUpdate: () => camera.lookAt(planetPosition)
        });
      }
    }
  }
  
  // Planet label on hover
  function onMouseMove(event) {
    mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
    mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
    
    raycaster.setFromCamera(mouse, camera);
    const intersects = raycaster.intersectObjects(planetMeshes.map(p => p.mesh));
    
    if (intersects.length > 0) {
      const planet = planetMeshes.find(p => p.mesh === intersects[0].object);
      planetLabel.textContent = planet.name;
      planetLabel.style.opacity = 1;
      planetLabel.style.left = (event.clientX + 10) + 'px';
      planetLabel.style.top = (event.clientY - 10) + 'px';
    } else {
      planetLabel.style.opacity = 0;
    }
  }
  
  window.addEventListener('click', onMouseClick);
  window.addEventListener('mousemove', onMouseMove);
  
  // Touch events for mobile
  let touchStartX, touchStartY;
  let touchPlanet = null;
  
  window.addEventListener('touchstart', function(event) {
    touchStartX = event.touches[0].clientX;
    touchStartY = event.touches[0].clientY;
    
    // Check if touching a planet
    mouse.x = (touchStartX / window.innerWidth) * 2 - 1;
    mouse.y = -(touchStartY / window.innerHeight) * 2 + 1;
    
    raycaster.setFromCamera(mouse, camera);
    const intersects = raycaster.intersectObjects(planetMeshes.map(p => p.mesh));
    
    if (intersects.length > 0) {
      touchPlanet = planetMeshes.find(p => p.mesh === intersects[0].object);
      event.preventDefault(); // Prevent scrolling when interacting with planets
    }
  });
  
  window.addEventListener('touchend', function(event) {
    const touchEndX = event.changedTouches[0].clientX;
    const touchEndY = event.changedTouches[0].clientY;
    
    // If it was a tap (not a swipe) and on a planet, show info
    if (touchPlanet && 
        Math.abs(touchEndX - touchStartX) < 10 && 
        Math.abs(touchEndY - touchStartY) < 10) {
      planetName.textContent = touchPlanet.name;
      planetInfo.textContent = touchPlanet.info;
      infoPanel.style.display = 'block';
    }
    
    touchPlanet = null;
  });

  // Music control
  const music = document.getElementById('backgroundMusic');
  const musicToggle = document.getElementById('musicToggle');
  
  musicToggle.addEventListener('click', () => {
    if (music.muted) {
      music.muted = false;
      musicToggle.textContent = 'ðŸ”Š';
      if (music.paused) music.play();
    } else {
      music.muted = true;
      musicToggle.textContent = 'ðŸ”‡';
    }
  });

  // Rotation sensitivity
  let rotationSensitivity = 1.5;
  document.getElementById('rotationSpeed').addEventListener('input', (e) => {
    rotationSensitivity = parseFloat(e.target.value);
  });

  // Simple orbit controls for 360Â° rotation
  let isMouseDown = false;
  let previousMousePosition = { x: 0, y: 0 };
  
  function onMouseDown(event) {
    isMouseDown = true;
    previousMousePosition = { x: event.clientX, y: event.clientY };
  }
  
  function onMouseUp() {
    isMouseDown = false;
  }
  
  function onMouseMove(event) {
    if (!isMouseDown) return;
    
    const deltaMove = {
      x: event.clientX - previousMousePosition.x,
      y: event.clientY - previousMousePosition.y
    };
    
    // Rotate the camera around the scene
    camera.position.x -= deltaMove.x * 0.01 * rotationSensitivity;
    camera.position.y += deltaMove.y * 0.01 * rotationSensitivity;
    
    // Keep the camera looking at the center
    camera.lookAt(0, 0, 0);
    
    previousMousePosition = { x: event.clientX, y: event.clientY };
  }
  
  // Touch events for mobile rotation
  function onTouchStart(event) {
    if (event.touches.length === 1) {
      isMouseDown = true;
      previousMousePosition = { x: event.touches[0].clientX, y: event.touches[0].clientY };
      event.preventDefault();
    }
  }
  
  function onTouchEnd() {
    isMouseDown = false;
  }
  
  function onTouchMove(event) {
    if (!isMouseDown || event.touches.length !== 1) return;
    
    const deltaMove = {
      x: event.touches[0].clientX - previousMousePosition.x,
      y: event.touches[0].clientY - previousMousePosition.y
    };
    
    // Rotate the camera around the scene
    camera.position.x -= deltaMove.x * 0.01 * rotationSensitivity;
    camera.position.y += deltaMove.y * 0.01 * rotationSensitivity;
    
    // Keep the camera looking at the center
    camera.lookAt(0, 0, 0);
    
    previousMousePosition = { x: event.touches[0].clientX, y: event.touches[0].clientY };
    event.preventDefault();
  }
  
  // Add event listeners for rotation
  document.addEventListener('mousedown', onMouseDown);
  document.addEventListener('mouseup', onMouseUp);
  document.addEventListener('mousemove', onMouseMove);
  document.addEventListener('touchstart', onTouchStart);
  document.addEventListener('touchend', onTouchEnd);
  document.addEventListener('touchmove', onTouchMove);

  // Animation loop
  function animate() {
    requestAnimationFrame(animate);

    // Auto-rotate if enabled
    if (autoRotate && !isMouseDown) {
      camera.position.x = Math.sin(Date.now() * 0.0001) * 100;
      camera.position.z = Math.cos(Date.now() * 0.0001) * 100;
      camera.lookAt(0, 0, 0);
    }

    // Rotate the sun
    sun.rotation.y += 0.001;
    sunGlow.rotation.y += 0.0005;
    
    // Animate planets
    planetMeshes.forEach(p => {
      p.angle += p.speed * speedMode;
      p.mesh.position.x = p.orbitRadius * Math.cos(p.angle);
      p.mesh.position.z = p.orbitRadius * Math.sin(p.angle);
      
      // Rotate planets on their axis
      p.mesh.rotation.y += 0.01;
    });

    // Moon around Earth
    const earth = planetMeshes.find(p => p.name === "Earth");
    if (earth) {
      const moonAngle = Date.now() * 0.002;
      moon.position.x = earth.mesh.position.x + 4 * Math.cos(moonAngle);
      moon.position.z = earth.mesh.position.z + 4 * Math.sin(moonAngle);
      moon.rotation.y += 0.01;
    }

    // Make Saturn's rings face the sun
    if (saturn) {
      saturn.mesh.children[0].lookAt(sun.position);
    }

    renderer.render(scene, camera);
  }
  
  // Set initial camera position
  camera.position.set(0, 50, 100);
  camera.lookAt(0, 0, 0);
  
  // Start animation
  animate();

  // Handle window resize
  window.addEventListener('resize', () => {
    renderer.setSize(window.innerWidth, window.innerHeight);
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
  });

  // Auto-start music with interaction
  document.body.addEventListener('click', function initAudio() {
    if (music.paused) {
      music.play().catch(e => console.log("Audio play failed:", e));
    }
    document.body.removeEventListener('click', initAudio);
  });

  // Hide loading screen once everything is loaded
  setTimeout(() => {
    document.getElementById('loading').style.display = 'none';
  }, 1000);
</script>
</body>
</html>
